<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm border-bottom sticky-top py-3">
  <div class="container-fluid px-4">
    <!-- Left: Brand and Navigation Links -->
    <div class="d-flex align-items-center">
      <a class="navbar-brand fs-4 fw-bold text-primary me-4" href="/main">
        <i class="fa-regular fa-compass me-2"></i>StayEasy
      </a>
      
      <!-- Mobile toggle button -->
      <button class="navbar-toggler border-0 ms-auto d-lg-none" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent" aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarContent">
      <!-- Navigation Links -->
      <div class="navbar-nav me-auto ms-lg-3">
        <a class="nav-link px-3 py-2 rounded-pill fw-medium" href="/listings">All Places</a>
        <% if (currentUser) { %>
          <a class="nav-link px-3 py-2 rounded-pill fw-medium" href="/listings/new">
            <i class="fas fa-plus me-1"></i>Add New
          </a>
        <% } %>
      </div>

      <!-- Center: Search Bar (Desktop) -->
      <% if (currentUser) { %>
      <form class="d-none d-lg-flex mx-auto position-relative" action="/listings/search" method="GET" style="width: 400px;">
        <div class="input-group">
          <input class="form-control border-0 bg-light rounded-pill ps-4 pe-5" 
                 type="search" 
                 name="q" 
                 placeholder="Search destinations, properties..." 
                 style="box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
          <button class="btn btn-link position-absolute end-0 top-50 translate-middle-y me-3 p-0 border-0" 
                  type="submit" 
                  style="z-index: 10;">
            <i class="fas fa-search text-muted"></i>
          </button>
        </div>
      </form>
      <% } %>

      <!-- Right: Auth/Profile -->
      <div class="navbar-nav ms-auto">
        <% if (!currentUser) { %>
          <div class="d-flex flex-column flex-lg-row gap-2 mt-3 mt-lg-0">
            <a class="nav-link px-3 py-2 rounded-pill fw-medium" href="/signin">Sign In</a>
            <a class="btn btn-primary rounded-pill px-4 py-2" href="/signup">Sign Up</a>
          </div>
        <% } else { %>
          <div class="dropdown">
            <button class="btn btn-light rounded-pill px-4 py-2 d-flex align-items-center gap-2 dropdown-toggle border-0" 
                    type="button" 
                    id="profileDropdown" 
                    data-bs-toggle="dropdown" 
                    aria-expanded="false"
                    style="box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
              <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" 
                   style="width: 32px; height: 32px; font-size: 14px; font-weight: 600;">
                <%= currentUser.username.charAt(0).toUpperCase() %>
              </div>
              <span class="fw-medium d-none d-md-inline"><%= currentUser.username %></span>
            </button>
            <ul class="dropdown-menu dropdown-menu-end mt-2 border-0 shadow-lg rounded-3" 
                aria-labelledby="profileDropdown"
                style="min-width: 200px;">
              <li>
                <a class="dropdown-item py-3 px-4 d-flex align-items-center gap-3" href="/profile">
                  <i class="fas fa-user text-muted" style="width: 16px;"></i>
                  <span>My Profile</span>
                </a>
              </li>
              <li>
                <a class="dropdown-item py-3 px-4 d-flex align-items-center gap-3" href="/profile/settings">
                  <i class="fas fa-cog text-muted" style="width: 16px;"></i>
                  <span>Settings</span>
                </a>
              </li>
              <li>
                <a class="dropdown-item py-3 px-4 d-flex align-items-center gap-3" href="/listings/my">
                  <i class="fas fa-home text-muted" style="width: 16px;"></i>
                  <span>My Listings</span>
                </a>
              </li>
              <li><hr class="dropdown-divider my-2"></li>
              <li>
                <form action="/logout" method="POST" class="d-inline w-100">
                  <button class="dropdown-item py-3 px-4 d-flex align-items-center gap-3 text-danger border-0 bg-transparent w-100 text-start" 
                          type="submit">
                    <i class="fas fa-sign-out-alt" style="width: 16px;"></i>
                    <span>Logout</span>
                  </button>
                </form>
              </li>
            </ul>
          </div>
        <% } %>
      </div>

      <!-- Mobile Search Bar -->
      <% if (currentUser) { %>
      <form class="d-lg-none mt-3 w-100" action="/listings/search" method="GET">
        <div class="input-group">
          <input class="form-control border-0 bg-light rounded-pill ps-4 pe-5" 
                 type="search" 
                 name="q" 
                 placeholder="Search destinations, properties...">
          <button class="btn btn-link position-absolute end-0 top-50 translate-middle-y me-3 p-0 border-0" 
                  type="submit" 
                  style="z-index: 10;">
            <i class="fas fa-search text-muted"></i>
          </button>
        </div>
      </form>
      <% } %>
    </div>
  </div>
</nav>

<!-- Additional CSS for enhanced styling -->
<style>
.navbar-brand:hover {
  transform: translateY(-1px);
  transition: transform 0.2s ease;
}

.nav-link {
  transition: all 0.2s ease;
  border: 1px solid transparent;
}

.nav-link:hover {
  background-color: #f8f9fa;
  border-color: #e9ecef;
  transform: translateY(-1px);
}

.btn-primary {
  background: linear-gradient(135deg, #007bff, #0056b3);
  border: none;
  transition: all 0.3s ease;
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
}

.dropdown-menu {
  animation: slideDown 0.2s ease;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.dropdown-item:hover {
  background-color: #f8f9fa;
  border-radius: 8px;
  margin: 0 8px;
  width: calc(100% - 16px);
}

@media (max-width: 991.98px) {
  .navbar-collapse {
    background-color: white;
    border-radius: 12px;
    margin-top: 12px;
    padding: 20px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
  }
}

/* Search input focus styles */
.form-control:focus {
  box-shadow: 0 4px 12px rgba(0, 123, 255, 0.2);
  border-color: #007bff;
}
</style>